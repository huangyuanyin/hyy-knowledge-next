; (function () {
  tinymce.PluginManager.add('customHyy', function (editor) {
    editor.ui.registry.addButton('custom_button', {
      text: 'custom_button', tooltip: '自定义', onAction: function () {
        editor.windowManager.openUrl({
          title: '上传附件', url: 'http://127.0.0.1:8029/article/attachments/', width: 600, height: 400, buttons: [{ type: 'cancel', text: '取消' }], onMessage: function (api, message) {
            if (message.type === 'file-uploaded') {
              const { fileUrl, fileName } = message.data
              editor.insertContent(`<a href="${fileUrl}"target="_blank">${fileName}</a>`)
              api.close()
            }
          }
        })
      }
    })
  })
})()